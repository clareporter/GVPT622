---
title: "Problem Set 5"
name: "Clare Porter"
subtitle: "Due date: 28 October"
format: 
  html:
    self-contained: true
toc: true
editor: visual
execute: 
  echo: true
---

Please upload your completed assignment to the ELMs course site (under the assignments menu) and to your class Github repository. You need to upload both your Quarto document (with R code, as needed) and its rendered output (either as a PDF or HTML file).

**Total points: 25**

## Question 1

*Total points: 6*

Use the data in the table below to answer the following questions.

```{r}
#| echo: false

tibble::tibble(
  `Age group` = c("18-24", "25-30", "31 and up", "TOTAL"),
  `Non-voters` = c(70, 40, 220, 330),
  Voters = c(50, 50, 570, 670),
  Total = `Non-voters` + Voters
) |> 
  knitr::kable(caption = "Voting by Age in 2000")
```

### Part A

*Points: 2*

What is the probability of being 25-30 or a non-voter?

There is a 38% probability of being 25-30 or a non-voter.

```{r}
P(25-30 or non-voter) = P(25-30) + P(non-voter) - P(25-30 & non-voter)
= 90/1000 + 330/1000 - 40/1000 = 0.38 or 380/1000
```

### Part B

*Points: 4*

Assuming a normal distribution, report the 95% confidence intervals for the percentage of 18-to-24-year-olds who did not vote, and then the percentage of 25-to-30-year-olds who did not vote.

49.5% - 67.15% of 18-to-24 year olds did not vote.

34.18% - 54.71% of 25-30 year olds did not vote.

```{r}

# CI = p +- 1.96*se 
#    = p +- 1.96*sqrt(p(1-p)/n)
#    = p(notvote) +- 1.96*sqrt(p(notvote)(1-p(notvote))/ totl18to24)

# 18-to-24yo:
# p(18-to-24yo & notvote) = 70/120 = 0.5833
# se = sqrt((70/120)*(50/120)/120) = sqrt(0.002025) = 0.045
# CI = 0.5833 +- 1.96*0.045 = 0.5833 +- 0.0882
#    = 0.4951 & 0.6715

# 25-to-30yo:
# p(25-to-30yo & notvote) = 40/90 = 0.444
# se = sqrt ((40/90)*(50/90)/90) = sqrt(0.002743) = 0.0524
# CI = 0.444 +- 1.96*0.0524
#    = 0.3418 & 0.5471
```

## Question 2

*Total points:* *7*

Assume that the standard deviation for the population distribution of a state in which you want to conduct a poll is 200.

### Part A

*Points: 3*

Calculate the spread of the sampling distribution for each of the following sample sizes: 1, 4, 25, 100, 250, 1000, 5,000, and 10,000.

The spread of the sampling distribution for each sample is as follows:

-   1 = 200

-   4 = 100

-   25 = 40

-   100 = 20

-   250 = 12.65

-   1000 = 6.32

-   5000 = 2.83

-   10000 = 2

```{r}
# SampleSD = popSD / sqrt(samplesize)
# SampleSD =
#    200/sqrt(1) = 200
#    200/sqrt(4) = 100
#    200/sqrt(25) = 40
#    200/sqrt(100) = 20
#    200/sqrt(250) = 12.65
#    200/sqrt(1000) = 6.32
#    200/sqrt(5000) = 2.83
#    200/sqrt(10000) = 2
```

### Part B

*Points: 1*

Describe specifically how the variability of the sampling distribution changes as the sample size varies. Considering the expense of running a poll, which sample size do you think is most optimal if conducting the poll?

The larger the sample, the more precise an estimate of the sampling distribution, but at a diminishing rate.

A poll of 1000 would significantly decrease the spread of the sampling distribution without shouldering expenses for significant increased precision. The improvement from 100 to 1,000 in the spread of the sampling distribution is significant, but the improvement from 1,000 to 10,000 yields a much smaller improvement for a large increase in expense to running the poll.

### Part C

*Points: 3*

Display your results graphically (using R) with the sample size on the x-axis and the standard error (of the sampling distribution) on the y-axis.

See the graph produced below:

```{r}
## Build the data frame
sample <- c(1, 4, 25, 100, 250, 1000, 5,000, 10,000)
se <- 200/sqrt(sample)
df <- data.frame(
  SampleSize = sample,
  StandardError = se
)

ggplot(df, aes(x = SampleSize, y = StandardError)) +
  geom_line(color = "blue", size = 1) +
  geom_point(color = "red") +
  labs(
    title = "Spread of the Sampling Distribution vs. Sample Size",
    x = "Sample Size",
    y = "Standard Error"
  ) +
  theme_minimal()
```

## Question 3

*Points: 4*

Suppose you conduct a survey (to generate a sample mean of interest) and find that it has a margin of error of 4.5 with a sample size of 900 using a 95% confidence interval. What would the margin of error be for a 90% confidence interval?

The margin of error for a 90% confidence interval is about 3.77.

```{r}
# Margin of Error = z*(se)
# MOE(95%) = 4.5 = 1.96*se
# se = 2.2959
# MOE(90%) = X = 1.645*se = 1.645*2.2959 = 3.7767555
```

## Question 4

*Points: 4*

Assume that, in State A, the mean income in the population is \$20,000 with a standard deviation of \$2,000. If you took an SRS of 900 individuals from that population, what is the probability that you would get a sample mean income of \$20,200 or greater? What would be the probability if the sample size was only 25?

For a sample of 900 individuals, there is a 0.13% probability you get a sample mean income of 20,200 or greater.

For a sample of 25 individuals, there is a 30.85% probability you get a sample mean income of 20,200 or greater.

::: callout-note
Assume a normal distribution for both questions.
:::

```{r}
# Sample size = 900
# Standard error = 2000/(sqrt 900) = 200/3
# Z score = (20200 - 20000)/(200/3) = 200/200/3 = 3
# Using the Z score table we find a probability of 0.9987
# 1-0.9987 = 0.0013 == a 0.13% probability you get a sample mean income of 20,200 or greater for a sample of 900 individuals

# Sample size = 25
# Standard error = 2000/(sqrt 25) = 2000/5
# Z score = (20200 - 20000)/(2000/5) = 200/2000/5 = 0.5
# Using the Z score table we find a probability of 0.6915
# 1-0.6915 = 0.3085 == a 30.85% probability you get a sample mean income of 20,200 or greater for a sample of 25 individuals
```

## Question 5

*Points: 4*

Assume that a coin is fair. If I flip a coin 500 times, what is a 95% confidence interval for the range of the count of heads that I will get? What if I flip the coin 5,000 times? What about 50,000 times?

A 95% confidence interval for the range of the count of heads that I will get if I flip a coin 500 times is \~(228, 272).

A 95% confidence interval for the range of the count of heads that I will get if I flip a coin 5,000 times is \~(2,431, 2,569).

A 95% confidence interval for the range of the count of heads that I will get if I flip a coin 50,000 times is \~(24,781, 25,219).

```{r}
# 500 times
# Mean = 500*0.5 = 250
# Standard deviation = sqrt(np(1-p)) = sqrt(250(1-0.5)) = sqrt(125) = 11.18
# CI = 250 +- 1.96(11.18) = 250 +- 21.9
# CI = ~(228, 272)

# 5,000 times
# Mean = 5000*0.5 = 2500
# Standard deviation = sqrt(np(1-p)) = sqrt(2500(1-0.5)) = sqrt(1250) = 35.35
# CI = 2500 +- 1.96(35.35) = 2500 +- 69.29
# CI = ~(2,431, 2,569)

# 50,000 times
# Mean = 50,000*0.5 = 25,000
# Standard deviation = sqrt(np(1-p)) = sqrt(25,000(1-0.5)) = sqrt(125,000) = 111.80
# CI = 25,000 +- 1.96(111.80) = 25,000 +- 219.1
# CI = ~(24,781, 25,219)
```
