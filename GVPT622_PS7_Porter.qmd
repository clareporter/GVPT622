---
title: "Problem Set 7"
subtitle: "Due date: 11 November"
name: "Clare Porter"
format: 
  html:
    self-contained: true
toc: true
editor: visual
execute: 
  echo: true
  warning: false
---

Please upload your completed assignment to the ELMs course site (under the assignments menu) and to your class Github repository. You need to upload both your Quarto document (with R code, as needed) and its rendered output (either as a PDF or HTML file).

**Total points: 20**

::: callout-note
19/20
:::

```{r}
library(tidyverse)
library(modelsummary)
library(infer)
library(poliscidata)
```

## Question 1

*Total points: 10*

I hypothesize that the older someone is, the more they like watching golf. I conduct a survey based on an SRS of adults in America. The independent variable is a four-category measure of age: 21-35, 36-50, 51-65, 66-plus. The dependent variable is a three-category measure of how much they enjoy watching golf: not at all, somewhat, very much.

### Part A

*Points: 4*

::: callout-note
4/4
:::

Make a cross-tab, by hand, of the relationship between these two variables based on the following (completely made up) data. Make sure that you present both raw counts and the appropriate percentages to examine the relationship.

Raw Counts and Proportions:

+-----------+--------------+-------------+-------------+-------+
| Age       | Not at all   | Somewhat    | Very Much   | Total |
+===========+==============+=============+=============+=======+
| 21-35     | 5            | 6           | 1           | 12    |
|           |              |             |             |       |
|           | 5/12 = 0.417 | 6/12=0.5    | 1/12= 0.083 |       |
+-----------+--------------+-------------+-------------+-------+
| 36-50     | 1            | 5           | 3           | 9     |
|           |              |             |             |       |
|           | 1/9=0.111    | 5/9=0.556   | 3/9=0.333   |       |
+-----------+--------------+-------------+-------------+-------+
| 51-65     | 2            | 2           | 4           | 8     |
|           |              |             |             |       |
|           | 2/8=0.25     | 2/8=0.25    | 4/8=0.5     |       |
+-----------+--------------+-------------+-------------+-------+
| 66+       | 3            | 4           | 4           | 11    |
|           |              |             |             |       |
|           | 3/11= 0.273  | 4/11= 0.364 | 4/11= 0.364 |       |
+-----------+--------------+-------------+-------------+-------+
| **Total** | 11           | 17          | 12          | 40    |
+-----------+--------------+-------------+-------------+-------+

: Expected counts: (row total)\*(col total)/N

+-----------+-------------+-------------+-------------+-------+
| Age       | Not at all  | Somewhat    | Very Much   | Total |
+===========+=============+=============+=============+=======+
| 21-35     | (12\*11/40) | (12\*17/40) | (12\*12/40) | 12    |
|           |             |             |             |       |
|           | =3.3        | =5.1        | =3.6        |       |
+-----------+-------------+-------------+-------------+-------+
| 36-50     | (9\*11/40)  | (9\*17/40)  | (9\*12/40)  | 9     |
|           |             |             |             |       |
|           | =2.475      | =3.825      | =2.7        |       |
+-----------+-------------+-------------+-------------+-------+
| 51-65     | (8\*11/40)  | (8\*17/40)  | (8\*12/40)  | 8     |
|           |             |             |             |       |
|           | =2.2        | =3.4        | =2.4        |       |
+-----------+-------------+-------------+-------------+-------+
| 66+       | (11\*11/40) | (11\*17/40) | (11\*12/40) | 11    |
|           |             |             |             |       |
|           | =3.025      | =4.675      | =3.3        |       |
+-----------+-------------+-------------+-------------+-------+
| **Total** | 11          | 17          | 12          | 40    |
+-----------+-------------+-------------+-------------+-------+

Let's check my work and graphs the results:

```{r}
age_golf_df <- tibble::tibble(
  age = c("21-35", "51-65", "66-plus", "21-35", "36-50", "21-35", "36-50",
          "66-plus", "36-50", "51-65", "51-65", "21-35", "36-50", "21-35",
          "66-plus", "51-65", "36-50", "66-plus", "51-65", "21-35", "66-plus",
          "21-35", "36-50", "66-plus", "21-35", "36-50", "21-35", "66-plus",
          "51-65", "51-65", "66-plus", "21-35", "66-plus", "21-35", "51-65",
          "66-plus", "21-35", "36-50", "36-50", "66-plus"),
  preference = c("Somewhat", "Not at all", "Very much", "Not at all", "Somewhat",
                 "Not at all", "Not at all", "Somewhat", "Very much", "Very much",
                 "Somewhat", "Not at all", "Somewhat", "Very much", "Not at all",
                 "Not at all", "Somewhat", "Somewhat", "Very much", "Somewhat",
                 "Very much", "Somewhat", "Very much", "Somewhat", "Not at all",
                 "Very much", "Somewhat", "Somewhat", "Somewhat", "Very much",
                 "Not at all", "Not at all", "Very much", "Somewhat", "Very much",
                 "Very much", "Somewhat", "Somewhat", "Somewhat", "Not at all")
)

age_golf_df

datasummary_crosstab(age ~ preference, data=age_golf_df)

##Add a graph


## Raw counts and Percentages
crosstab <- age_golf_df %>%
  count(age, preference) %>%
  group_by(age) %>%
  mutate(percent = 100 * n / sum(n))

crosstab

## Table summary 
datasummary_crosstab(age ~ preference, data = age_golf_df)

## Let's graph this 
ggplot(crosstab, aes(x = age, y = percent, fill = preference)) +
  geom_bar(stat = "identity", position = "fill") +
  scale_y_continuous(labels = scales::percent_format()) +
  scale_fill_brewer(palette = "Set2") +
  labs(
    title = "Enjoyment of Watching Golf by Age Group",
    x = "Age Group",
    y = "Percent within Age Group",
    fill = "Enjoys Watching Golf"
  ) +
  theme_minimal(base_size = 13)
```

### Part B

*Points: 2*

::: callout-note
2/2
:::

Do the data support my hypothesis? Be sure to explain the nature of the relationship (or lack thereof, if relevant).

There is a generally position relationship between age and enjoyment, with 51-65 year olds showing the highest enjoyment of golf, and youngest adults, 21-35 year olds, are the least likely to enjoy golf. However, the trend is not linear because a smaller proportion of 66+ year olds like golf "very much" (36.4%) than 51-65 year olds (50%).

While this data supports some trend of a relationship between older people and liking golf, the trend is not strong enough to conclude with certainty that the older someone is, the more they like watching golf.

### Part C

*Points: 2*

::: callout-note
2/2
:::

Compute (by hand) the chi-square statistic to test the null hypothesis of no relationship between these two variables. Be sure to show your work.

|                            |
|----------------------------|
| Chi-Square: (O - E)\^2 / E |

+-----------+----------------+----------------+-----------------------+-------+
| Age       | Not at all     | Somewhat       | Very Much             | Total |
+===========+================+================+=======================+=======+
| 21-35     | (5-3.3)\^2/3.3 | (6-5.1)\^2/5.1 | (1-3.6)\^2/3.6        | 2.912 |
|           |                |                |                       |       |
|           | =0.876         | =0.159         | =1.878                |       |
+-----------+----------------+----------------+-----------------------+-------+
| 36-50     | (1-2.475)\^2   | (5-3.825)\^2   | (3-2.7)\^2/2.7        | 1.273 |
|           |                |                |                       |       |
|           | /2.475         | /3.825         | =0.033                |       |
|           |                |                |                       |       |
|           | =0.879         | =0.361         |                       |       |
+-----------+----------------+----------------+-----------------------+-------+
| 51-65     | (2-2.2)\^2/2.2 | (2-3.4)\^2/3.4 | (4-2.4)\^2/2.4 =1.067 | 1.661 |
|           |                |                |                       |       |
|           | =0.018         | =0.576         |                       |       |
+-----------+----------------+----------------+-----------------------+-------+
| 66+       | (3- 3.025)\^2  | (4-4.675)\^2   | (4-3.3)\^2/3.3 =0.148 | 0.246 |
|           |                |                |                       |       |
|           | /3.025 =0.0002 | /4.675 =0.097  |                       |       |
+-----------+----------------+----------------+-----------------------+-------+
| **Total** |                |                |                       | 6.093 |
+-----------+----------------+----------------+-----------------------+-------+

: With 6 degrees of freedom \[(r-1)(c-1)=3\*2\]

Let's check my work:

```{r}
chisq.test(age_golf_df$age, age_golf_df$preference)
```

### Part D

*Points: 2*

::: callout-note
2/2
:::

Using the chi-square statistic that you computed in question 1(c), can you reject the null hypothesis of no relationship between these two variables with 95% confidence? Why, or why not?

No, as suspected, you cannot reject the null hypothesis of no relationship between these two variables with such a high p-value (p-value = 0.4128). This chi-square statistic tells us that there is not a statistically significant relationship between age and liking golf at the 95% confidence level. Given the small sample size (n=40), it would be difficult to achieve this high of a confidence level.

## Question 2

*Points: 10*

::: callout-note
9/10
:::

I hypothesize that people with higher levels of education tend to be more likely to pay higher levels of attention to politics. Use the `nes2024` dataset from the `polisciols` package to test my hypothesis. Create a cross-tab examining the relationship between individuals' levels of education (`education`) and the time they spend paying attention to politics (`attention_to_politics`).

Do the data support my hypothesis? Be sure to explain the nature of the relationship (or lack thereof, if relevant). Report a chi-square statistic. What does the chi-square statistic tell you about whether you can reject the null hypothesis of no relationship between these two variables with 95% confidence? Why, or why not?

Our hypothesis wants to know if there is a positive relationship between these variables. By comparing the proportion of attention paid in politics across a range of levels fo education, the cross-tab demonstrates an upward trend between education level and attention paid to politics. Those with less high school credential report a smaller attention level to politics whereas those with graduate degrees are most concentrated as having responded "always" and "most of the time" in attention level to politics.

We can use a chi-squared test to confirm this association. The chi-squared test, cannot, however, tell us the direction of the relationship between attention level to politics and education.

For the chi-squared test, the hypotheses are therefore:

-   Null Hypothesis: There is no relationship between education level and level of attention to politics.

-   Alternative Hypothesis: There is a relationship between education level and level of attention to politics.

The chi-square statistic is very large (X-squared = 218.11) and the p-value (p-value \< 2.2e-16) is much smaller than our threshold of 0.05. We can therefore reject our null hypothesis with 95% confidence and conclude that there is a strong relationship between education level and level of attention to politics.

While this statistic confirms an association, we cannot use this statistic to conclude our original hypotheses which assigns directionality to the relationship between education level and level fo attention to politics.

```{r}
## Save dataset
nes2024 <- polisciols::nes2024 |>
  drop_na()

datasummary_crosstab(attention_to_politics ~ education, data=nes2024)
chisq.test(nes2024$attention_to_politics, nes2024$education)

```

::: callout-note
By running:

```         
polisciols::nes2024 |>
  drop_na()
```

You drop all observations that have missing values for any question, including those you do not care about in this analysis. You should not do this: you lose data unnecessarily. To illustrate:

```{r}
polisciols::nes2024 %>% 
  drop_na() %>% 
  nrow()
```

Compared to:

```{r}
polisciols::nes2024 %>% 
  select(attention_to_politics, education) %>% 
  drop_na() %>% 
  nrow()
```
:::
